generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ADMIN
  USER
}

model Episode {
  id           Int                    @id @default(autoincrement())
  title        String                 @unique
  number       Int
  releaseDate  DateTime
  createdAt    DateTime               @default(now())
  description  String
  caseNumber   String
  season       Int                    @default(1)
  characters   EpisodesOnCharacters[]
  userEpisodes UserEpisodes[]
}

model Character {
  id          Int                    @id @default(autoincrement())
  name        String                 @unique
  description String
  episodes    EpisodesOnCharacters[]
}

model EpisodesOnCharacters {
  episodeId   Int
  characterId Int
  episode     Episode   @relation(fields: [episodeId], references: [id], onDelete: Cascade)
  character   Character @relation(fields: [characterId], references: [id], onDelete: Cascade)

  @@id([episodeId, characterId])
}

model User {
  id            Int            @id @default(autoincrement())
  username      String         @unique
  password      String
  mail          String         @unique
  role          UserRole       @default(USER)
  episodesHeard UserEpisodes[]
}

model UserEpisodes {
  userId    Int
  episodeId Int
  heard     Boolean @default(false)
  user      User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  episode   Episode @relation(fields: [episodeId], references: [id], onDelete: Cascade)

  @@id([userId, episodeId])
}
